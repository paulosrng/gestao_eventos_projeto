{% load static %}
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="SGEA - Sistema de Gestão de Eventos Acadêmicos">
    <title>{% block title %}SGEA - Gestão de Eventos{% endblock %}</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="stylesheet" href="{% static 'gestao_app/css/styles.css' %}">
</head>
<body class="bg-gray-100 flex flex-col min-h-screen">

    <header>
        <nav class="bg-white shadow-md" role="navigation" aria-label="Menu Principal">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex items-center justify-between h-16">
                    
                    <div class="flex-shrink-0">
                        <a href="{% url 'listar_eventos' %}" class="brand-logo text-2xl text-blue-600 hover:text-blue-800 transition">
                            <i class="fa-solid fa-graduation-cap fa-lg"></i> <span>SGEA</span>
                        </a>
                    </div>
                    
                    <div class="hidden md:flex items-center space-x-6">
                        {% if user.is_authenticated %}
                            <a href="{% url 'listar_eventos' %}" class="text-gray-600 hover:text-blue-600 font-medium"><i class="fa-solid fa-calendar-days"></i> Eventos</a>
                            
                            <a href="{% url 'minhas_inscricoes' %}" class="text-gray-600 hover:text-blue-600 font-medium"><i class="fa-solid fa-ticket"></i> Minhas Inscrições</a>
                            
                            {% if user.perfil == 'ORGANIZADOR' %}
                                <div class="relative group ml-4 pl-4 border-l border-gray-300">
                                    <span class="text-xs font-bold text-gray-400 uppercase tracking-wider block mb-1">Gestão</span>
                                    <div class="flex space-x-4">
                                        <a href="{% url 'meus_eventos' %}" class="text-gray-600 hover:text-blue-600" title="Painel Administrativo"><i class="fa-solid fa-gauge-high"></i> Painel</a>
                                        <a href="{% url 'criar_evento' %}" class="text-gray-600 hover:text-blue-600" title="Criar Evento"><i class="fa-solid fa-plus-circle"></i> Novo</a>
                                        <a href="{% url 'cadastrar_participante' %}" class="text-gray-600 hover:text-blue-600" title="Cadastrar Usuário"><i class="fa-solid fa-user-plus"></i> User</a>
                                        <a href="{% url 'relatorio_auditoria' %}" class="text-gray-600 hover:text-blue-600" title="Auditoria e Logs"><i class="fa-solid fa-shield-halved"></i> Logs</a>
                                    </div>
                                </div>
                            {% endif %}
                            
                            <a href="{% url 'logout' %}" class="ml-4 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-semibold shadow-sm transition">
                                <i class="fa-solid fa-right-from-bracket"></i> Sair
                            </a>
                        {% else %}
                            <a href="{% url 'login' %}" class="text-gray-600 hover:text-blue-600 font-medium"><i class="fa-solid fa-right-to-bracket"></i> Login</a>
                            <a href="{% url 'cadastrar_usuario' %}" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 font-semibold shadow-sm transition">Cadastrar</a>
                        {% endif %}
                    </div>

                    <div class="md:hidden">
                        <button id="mobile-menu-button" type="button" aria-controls="mobile-menu" aria-expanded="false" aria-label="Abrir menu principal" class="text-gray-600 hover:text-blue-600 focus:outline-none p-2 rounded-md">
                            <i class="fa-solid fa-bars fa-xl"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <div id="mobile-menu" class="md:hidden hidden bg-white border-t border-gray-200 shadow-inner">
                <div class="px-4 pt-4 pb-4 space-y-2">
                    {% if user.is_authenticated %}
                        <div class="pb-2 border-b border-gray-100 mb-2">
                            <span class="text-sm text-gray-500">Olá, <strong>{{ user.first_name|default:user.username }}</strong></span>
                        </div>
                        <a href="{% url 'listar_eventos' %}" class="block px-3 py-2 rounded-md font-medium text-gray-700 hover:bg-blue-50 hover:text-blue-700"><i class="fa-solid fa-calendar-days w-6"></i> Eventos</a>
                        <a href="{% url 'minhas_inscricoes' %}" class="block px-3 py-2 rounded-md font-medium text-gray-700 hover:bg-blue-50 hover:text-blue-700"><i class="fa-solid fa-ticket w-6"></i> Inscrições</a>
                        
                        {% if user.perfil == 'ORGANIZADOR' %}
                             <div class="mt-4 mb-2 text-xs font-bold text-gray-400 uppercase tracking-wider">Administração</div>
                             <a href="{% url 'meus_eventos' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:bg-blue-50 hover:text-blue-700">Painel Geral</a>
                             <a href="{% url 'criar_evento' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:bg-blue-50 hover:text-blue-700">Novo Evento</a>
                             <a href="{% url 'cadastrar_participante' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:bg-blue-50 hover:text-blue-700">Novo Usuário</a>
                             <a href="{% url 'relatorio_auditoria' %}" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:bg-blue-50 hover:text-blue-700">Auditoria</a>
                        {% endif %}
                        <div class="border-t border-gray-100 my-2"></div>
                        <a href="{% url 'logout' %}" class="block px-3 py-2 rounded-md font-medium text-red-600 hover:bg-red-50"><i class="fa-solid fa-right-from-bracket w-6"></i> Sair</a>
                    {% else %}
                        <a href="{% url 'login' %}" class="block px-3 py-2 rounded-md font-medium text-gray-700 hover:bg-blue-50 hover:text-blue-700">Login</a>
                        <a href="{% url 'cadastrar_usuario' %}" class="block px-3 py-2 bg-blue-600 text-white rounded-md font-medium text-center mt-2">Cadastrar-se</a>
                    {% endif %}
                </div>
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-4 py-8 flex-grow" role="main">
        {% if messages %}
            <div class="max-w-4xl mx-auto mb-6" aria-live="polite">
                {% for message in messages %}
                    <div class="p-4 rounded-md mb-2 relative flex items-center shadow-sm
                        {% if message.tags == 'success' %} bg-green-50 border border-green-200 text-green-800
                        {% elif message.tags == 'error' %} bg-red-50 border border-red-200 text-red-800
                        {% else %} bg-blue-50 border border-blue-200 text-blue-800 {% endif %}">
                        
                        <span class="mr-2">
                            {% if message.tags == 'success' %}<i class="fa-solid fa-check-circle"></i>
                            {% elif message.tags == 'error' %}<i class="fa-solid fa-circle-exclamation"></i>
                            {% else %}<i class="fa-solid fa-circle-info"></i>{% endif %}
                        </span>
                        
                        <span>{{ message }}</span>
                        
                        <button onclick="this.parentElement.style.display='none'" class="absolute top-0 bottom-0 right-0 px-4 py-3 cursor-pointer text-gray-500 hover:text-gray-800" aria-label="Fechar mensagem">
                            <i class="fa-solid fa-times"></i>
                        </button>
                    </div>
                {% endfor %}
            </div>
        {% endif %}

        {% block content %}
        {% endblock %}
    </main>

    <footer role="contentinfo" class="bg-white mt-auto">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 flex flex-col md:flex-row justify-between items-center">
            <div class="mb-4 md:mb-0">
                <span class="brand-logo text-lg text-gray-400">
                    <i class="fa-solid fa-graduation-cap"></i> SGEA
                </span>
                <p class="text-xs text-gray-500 mt-1">Sistema de Gestão de Eventos Acadêmicos</p>
            </div>
            <div class="text-sm text-gray-500">
                &copy; {% now "Y" %} SGEA. Todos os direitos reservados.
            </div>
        </div>
    </footer>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>
    <script src="{% static 'gestao_app/js/main.js' %}"></script>
    
    <script>
        const btn = document.getElementById('mobile-menu-button');
        const menu = document.getElementById('mobile-menu');

        btn.addEventListener('click', () => {
            menu.classList.toggle('hidden');
            const expanded = btn.getAttribute('aria-expanded') === 'true' || false;
            btn.setAttribute('aria-expanded', !expanded);
        });
    </script>
</body>
</html>